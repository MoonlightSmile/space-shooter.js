var y=Object.defineProperty;var f=(i,e,s)=>e in i?y(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var a=(i,e,s)=>(f(i,typeof e!="symbol"?e+"":e,s),s);import{P as h,p}from"./vendor.3d71c0c2.js";const b=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}};b();const g="0.0.0";class c extends Phaser.Physics.Arcade.Sprite{constructor(e,s,r,t){super(e,s,r,"laser-bolts");a(this,"speed");e.add.existing(this),e.physics.world.enable(this),this.body.setSize(8),this.body.isCircle=!0,this.setScale(d),this.speed=t,this.play(o.bolts2_run)}update(){this.y+=this.speed,this.y>this.scene.scale.height&&this.destroy()}}const k={"enemy-small":4,"enemy-medium":3,"enemy-big":2};class x extends Phaser.Physics.Arcade.Sprite{constructor(e,s,r,t){super(e,s,r,t);a(this,"speed");a(this,"bulletSpeed");a(this,"mainScene");a(this,"timer");this.mainScene=e,this.speed=k[t],this.bulletSpeed=this.speed+2,e.add.existing(this),this.setScale(d);const n=`${t}_run`;this.play(o[n]),this.timer=e.time.addEvent({callback:this.fire.bind(this),loop:!0,delay:1e3})}fire(){const e=new c(this.mainScene,this.x,this.y+8+4,this.bulletSpeed);this.mainScene.enemyBoltsGroup.add(e)}destroySelf(){this.y>this.scene.scale.height&&this.destroy(!0)}destroy(e){this.timer.destroy(),super.destroy(e)}update(e,s){this.y+=this.speed,this.destroySelf()}}class S extends Phaser.Physics.Arcade.Sprite{constructor(e,s,r){super(e,s,r,"ship");a(this,"speed",5);a(this,"cursor");a(this,"skins");e.add.existing(this),e.physics.world.enable(this),this.skins=e.add.group(),this.setCollideWorldBounds(!0),this.body.setSize(35),this.body.isCircle=!0,this.play(o.ship_run),this.setScale(d/2),this.cursor=this.scene.input.keyboard.createCursorKeys(),this.setSkin()}fire(){this.scene.sound.play("Laser_002",{volume:.1});const e=[this.x,this.x-20,this.x-40,this.x+20,this.x+40].map(s=>{const r=this.scene.physics.add.sprite(s,this.y-32,"ship").setScale(d).setFrame(18);return r.body.setSize(10),r.body.isCircle=!0,r});this.scene.boltsGroup.addMultiple(e)}setSkin(){const e=[28,29,30].map(s=>this.scene.add.sprite(this.x,this.y,"ship").setFrame(s));this.skins.addMultiple(e)}skinFollowPlayer(){this.skins.children.each(e=>e.setPosition(this.x,this.y))}update(...e){this.cursor.up.isDown&&(this.y-=this.speed),this.cursor.down.isDown&&(this.y+=this.speed),this.cursor.left.isDown&&(this.x-=this.speed),this.cursor.right.isDown&&(this.x+=this.speed),Phaser.Input.Keyboard.JustDown(this.cursor.space)&&this.fire(),this.skinFollowPlayer()}}class _ extends h.Scene{constructor(){super({key:"MainScene"});a(this,"coins",0);a(this,"coinsText");a(this,"speed",5);a(this,"bulletSpeed",10);a(this,"bg");a(this,"player");a(this,"boltsGroup");a(this,"enemyBoltsGroup");a(this,"enemyGroup")}create(){this.boltsGroup=this.physics.add.group(),this.enemyGroup=this.physics.add.group({runChildUpdate:!0}),this.enemyBoltsGroup=this.physics.add.group({runChildUpdate:!0}),this.sound.play("music",{loop:!0,volume:.2}),this.coinsText=this.add.dynamicBitmapText(16,16,"Minecraft",`Coins: ${this.coins}`).setDepth(9).setScale(1),this.bg=this.add.tileSprite(0,0,256,608,"desert-background").setDisplaySize(this.scale.width,this.scale.height).setOrigin(0),this.player=new S(this,this.scale.width/2,this.scale.height-32),this.physics.add.overlap(this.boltsGroup,this.enemyGroup,(e,s)=>{e.destroy(),s.body.enable=!1,this.anims.play({key:"explosion_run"},s),this.sound.play("Explode1",{volume:.1}),s.once(h.Animations.Events.ANIMATION_COMPLETE,()=>{s.destroy(),this.coinsText.text=`Coins: ${this.coins+=1}`})}),this.physics.add.overlap(this.player,this.enemyBoltsGroup,this.playerDestroyed.bind(this)),this.physics.add.overlap(this.player,this.enemyGroup,this.playerDestroyed.bind(this))}playerDestroyed(e,s){console.log(s),s instanceof c&&s.destroy(),this.coinsText.text=`Coins: ${this.coins=0}`,this.anims.play({key:"explosion_run"},e),this.sound.play("Explode1",{volume:.1}),e.body.enable=!1,e.once(h.Animations.Events.ANIMATION_COMPLETE,()=>{this.player.setAlpha(0),this.player.setX(this.scale.width/2),this.player.setY(this.scale.height-32),this.anims.play({key:"ship_run"},e),this.player.setAlpha(1);const r=this.tweens.createTimeline();r.add({targets:this.player,y:"-=60",duration:300}),r.add({targets:this.player,alpha:{from:1,to:0},repeat:5,duration:300,yoyo:!0,onComplete:()=>{r.destroy(),e.body.enable=!0,this.player.setAlpha(1)}}),r.play()})}generateEnemy(){const e=h.Math.RND.pick(["enemy-small","enemy-medium","enemy-big"]);this.enemyGroup.add(new x(this,h.Math.RND.between(0+16,this.scale.width-16),0,e))}checkBolts(){this.boltsGroup.children.each(e=>{const s=e;s.y<0?s.destroy():s.y-=this.bulletSpeed})}update(e,s){this.bg.tilePositionY-=1,this.player.update(),this.checkBolts(),this.enemyGroup.children.entries.length<6&&this.generateEnemy()}}class w extends p.exports.Scene{constructor(){super({key:"Preload"})}preload(){const e=this.add.text(this.scale.width/2,this.scale.height/2,"0%").setOrigin(.5);Object.entries(v).forEach(([s,r])=>{switch(this.load.setBaseURL("./assets/"),s){case"audio":r.forEach(t=>{this.load.audio(t.key,"audio/"+t.url)});break;case"sprites":r.forEach(t=>{this.load.spritesheet(t.key,"sprites/"+t.url,t.frame)});break;case"image":r.forEach(t=>{this.load.image(t.key,"image/"+t.url)});break}}),this.load.bitmapFont("Minecraft","font/font.png","font/font.xml"),this.load.on(p.exports.Loader.Events.PROGRESS,s=>{e.setText(`${parseInt(String(s*100))}%`)})}createAnimations(){this.anims.create({key:o.ship_run,frames:this.anims.generateFrameNumbers("ship",{frames:[0,1,2]}),repeat:-1,frameRate:10}),this.anims.create({key:o["enemy-small_run"],frames:this.anims.generateFrameNumbers("enemy-small",{}),repeat:-1,frameRate:10}),this.anims.create({key:o["enemy-medium_run"],frames:this.anims.generateFrameNumbers("enemy-medium",{}),repeat:-1,frameRate:10}),this.anims.create({key:o["enemy-big_run"],frames:this.anims.generateFrameNumbers("enemy-big",{}),repeat:-1,frameRate:10}),this.anims.create({key:o.bolts1_run,frames:this.anims.generateFrameNumbers("laser-bolts",{frames:[2,3]}),repeat:-1,frameRate:7}),this.anims.create({key:o.bolts2_run,frames:this.anims.generateFrameNumbers("laser-bolts",{frames:[0,1]}),repeat:-1,frameRate:7}),this.anims.create({key:o.explosion_run,frameRate:20,frames:this.anims.generateFrameNumbers("ship",{start:9,end:17})})}create(){this.createAnimations(),this.scene.start("MainScene")}}var o=(i=>(i.ship_run="ship_run",i["enemy-small_run"]="enemy-small_run",i["enemy-medium_run"]="enemy-medium_run",i["enemy-big_run"]="enemy-big_run",i.bolts1_run="bolts1_run",i.bolts2_run="bolts2_run",i.explosion_run="explosion_run",i))(o||{});const v={audio:[{key:"Explode1",url:"Explode1.wav"},{key:"Hit_Hurt2",url:"Hit_Hurt2.wav"},{key:"Jump1",url:"Jump1.wav"},{key:"Laser_002",url:"Laser_002.wav"},{key:"music",url:"music.wav"}],sprites:[{key:"enemy-big",url:"enemy-big.bmp",frame:{frameWidth:32,frameHeight:32}},{key:"enemy-medium",url:"enemy-medium.bmp",frame:{frameWidth:32,frameHeight:16}},{key:"enemy-small",url:"enemy-small.bmp",frame:{frameWidth:16,frameHeight:16}},{key:"explosion",url:"explosion.bmp",frame:{frameWidth:16,frameHeight:16}},{key:"laser-bolts",url:"laser-bolts.bmp",frame:{frameWidth:16,frameHeight:16}},{key:"pixelspritefont32",url:"pixelspritefont32.bmp",frame:{frameWidth:16,frameHeight:24}},{key:"ship",url:"space-shooter.png",frame:{frameWidth:114,frameHeight:109}}],image:[{key:"desert-background",url:"desert-background.png"}]},E=800,P=600,d=2;console.log("version",g);const l=new p.exports.Game({type:Phaser.AUTO,scene:[w,_],antialias:!0,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:E,height:P},physics:{default:"arcade",arcade:{gravity:{y:0}}}});window.g_game=l;window.addEventListener("blur",()=>m(!1));window.addEventListener("focus",()=>m(!0));document.addEventListener("visibilitychange",()=>{m(document.visibilityState==="visible")});function m(i){const e=l.scene.getScene("MainScene").scene;!e||(i?(e.resume(),l.sound.resumeAll()):(l.sound.pauseAll(),e.pause()))}
